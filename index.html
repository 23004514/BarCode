<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Barcode Generator</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --dark-gradient: linear-gradient(135deg, #141e30 0%, #243b55 100%);
        }
        
        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }
        
        .gradient-header {
            background: var(--primary-gradient);
            padding: 2rem 0;
            border-radius: 0 0 20px 20px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            color: white;
            margin-bottom: 2rem;
        }
        
        .gradient-card {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: none;
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .gradient-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
        }
        
        .btn-gradient {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-gradient:hover {
            background: var(--primary-gradient);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn-outline-gradient {
            background: transparent;
            color: #667eea;
            border: 2px solid #667eea;
            padding: 0.75rem 1.5rem;
            border-radius: 10px;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .btn-outline-gradient:hover {
            background: var(--primary-gradient);
            color: white;
            border-color: transparent;
        }
        
        .form-control-custom {
            border: 2px solid #e1e5eb;
            border-radius: 10px;
            padding: 0.75rem 1rem;
            transition: all 0.3s;
            font-size: 1rem;
        }
        
        .form-control-custom:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.25rem rgba(102, 126, 234, 0.25);
        }
        
        .barcode-container {
            background: white;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.05);
            min-height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px dashed #dee2e6;
            transition: border-color 0.3s;
        }
        
        .barcode-container.active {
            border-color: #667eea;
            border-style: solid;
        }
        
        .settings-card {
            background: #f8f9fa;
            border-left: 5px solid #667eea;
            border-radius: 10px;
            padding: 1.5rem;
        }
        
        .color-option {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            cursor: pointer;
            transition: transform 0.2s;
            border: 3px solid transparent;
        }
        
        .color-option:hover {
            transform: scale(1.1);
        }
        
        .color-option.active {
            border-color: #495057;
        }
        
        .barcode-type-badge {
            background: var(--dark-gradient);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .history-item {
            background: white;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
            cursor: pointer;
            border-left: 4px solid #667eea;
        }
        
        .history-item:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        .pulse {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0.7); }
            70% { box-shadow: 0 0 0 10px rgba(102, 126, 234, 0); }
            100% { box-shadow: 0 0 0 0 rgba(102, 126, 234, 0); }
        }
        
        .type-icon {
            font-size: 1.5rem;
            margin-right: 10px;
            color: #667eea;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .gradient-header {
                padding: 1.5rem 0;
                border-radius: 0 0 15px 15px;
            }
            
            .barcode-container {
                min-height: 250px;
                padding: 1.5rem;
            }
        }
        
        /* Loading animation */
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Header Section -->
    <header class="gradient-header">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <h1 class="display-5 fw-bold mb-3">
                        <i class="bi bi-upc-scan me-3"></i>Advanced Barcode Generator
                    </h1>
                    <p class="lead mb-0">Create professional barcodes for product labels, inventory management, and more.</p>
                </div>
                <div class="col-md-4 text-md-end">
                    <div class="barcode-type-badge">
                        <i class="bi bi-info-circle me-2"></i>Supports CODE128, EAN, UPC
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="container">
        <div class="row g-4">
            <!-- Left Column: Input & Settings -->
            <div class="col-lg-6">
                <!-- Input Card -->
                <div class="gradient-card p-4 mb-4">
                    <h3 class="h4 fw-bold mb-3">
                        <i class="bi bi-pencil-square me-2 text-primary"></i>Enter Your Data
                    </h3>
                    
                    <div class="mb-3">
                        <label for="barcodeData" class="form-label fw-semibold">Text or URL</label>
                        <div class="input-group">
                            <span class="input-group-text bg-light">
                                <i class="bi bi-text-left text-primary"></i>
                            </span>
                            <input type="text" 
                                   class="form-control form-control-custom" 
                                   id="barcodeData" 
                                   placeholder="Enter text, URL, product code, or any data..."
                                   value="https://example.com">
                            <button class="btn btn-gradient" type="button" id="generateBtn">
                                <i class="bi bi-lightning-fill me-2"></i>Generate
                            </button>
                        </div>
                        <div class="form-text mt-2">
                            Press <kbd>Enter</kbd> or click Generate to create barcode
                        </div>
                    </div>
                    
                    <!-- Barcode Type Selection -->
                    <div class="mb-4">
                        <label class="form-label fw-semibold">Barcode Type</label>
                        <div class="row g-2">
                            <div class="col-sm-3 col-6">
                                <div class="form-check card border p-3 text-center rounded-3" style="cursor: pointer;">
                                    <input class="form-check-input" type="radio" name="barcodeType" id="typeCode128" value="CODE128" checked>
                                    <label class="form-check-label fw-medium mt-2" for="typeCode128">
                                        <i class="bi bi-upc type-icon"></i>CODE128
                                    </label>
                                    <small class="text-muted d-block mt-1">Universal</small>
                                </div>
                            </div>
                            <div class="col-sm-3 col-6">
                                <div class="form-check card border p-3 text-center rounded-3" style="cursor: pointer;">
                                    <input class="form-check-input" type="radio" name="barcodeType" id="typeEAN13" value="EAN13">
                                    <label class="form-check-label fw-medium mt-2" for="typeEAN13">
                                        <i class="bi bi-123 type-icon"></i>EAN-13
                                    </label>
                                    <small class="text-muted d-block mt-1">Products</small>
                                </div>
                            </div>
                            <div class="col-sm-3 col-6">
                                <div class="form-check card border p-3 text-center rounded-3" style="cursor: pointer;">
                                    <input class="form-check-input" type="radio" name="barcodeType" id="typeUPC" value="UPC">
                                    <label class="form-check-label fw-medium mt-2" for="typeUPC">
                                        <i class="bi bi-upc-scan type-icon"></i>UPC-A
                                    </label>
                                    <small class="text-muted d-block mt-1">Retail</small>
                                </div>
                            </div>
                            <div class="col-sm-3 col-6">
                                <div class="form-check card border p-3 text-center rounded-3" style="cursor: pointer;">
                                    <input class="form-check-input" type="radio" name="barcodeType" id="typeCode39" value="CODE39">
                                    <label class="form-check-label fw-medium mt-2" for="typeCode39">
                                        <i class="bi bi-hash type-icon"></i>CODE39
                                    </label>
                                    <small class="text-muted d-block mt-1">Industry</small>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Color Options -->
                    <div class="mb-4">
                        <label class="form-label fw-semibold">Barcode Color</label>
                        <div class="d-flex flex-wrap gap-3">
                            <div class="color-option active" style="background: #667eea;" data-color="#667eea" title="Primary Blue"></div>
                            <div class="color-option" style="background: #764ba2;" data-color="#764ba2" title="Purple"></div>
                            <div class="color-option" style="background: #f5576c;" data-color="#f5576c" title="Red"></div>
                            <div class="color-option" style="background: #4facfe;" data-color="#4facfe" title="Light Blue"></div>
                            <div class="color-option" style="background: #00f2fe;" data-color="#00f2fe" title="Cyan"></div>
                            <div class="color-option" style="background: #141e30;" data-color="#141e30" title="Dark Blue"></div>
                            <div class="color-option" style="background: #333;" data-color="#333" title="Black"></div>
                            <div class="color-option" style="background: #0aa;" data-color="#0aa" title="Teal"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Settings Card -->
                <div class="gradient-card p-4 mb-4">
                    <h3 class="h4 fw-bold mb-3">
                        <i class="bi bi-sliders me-2 text-primary"></i>Customization Settings
                    </h3>
                    
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="widthSlider" class="form-label fw-medium">
                                Line Width: <span id="widthValue" class="text-primary fw-bold">2</span>px
                            </label>
                            <input type="range" class="form-range" id="widthSlider" min="1" max="5" step="0.5" value="2">
                        </div>
                        
                        <div class="col-md-6">
                            <label for="heightSlider" class="form-label fw-medium">
                                Height: <span id="heightValue" class="text-primary fw-bold">100</span>px
                            </label>
                            <input type="range" class="form-range" id="heightSlider" min="50" max="200" step="5" value="100">
                        </div>
                        
                        <div class="col-md-6">
                            <label for="fontSizeSlider" class="form-label fw-medium">
                                Font Size: <span id="fontSizeValue" class="text-primary fw-bold">16</span>px
                            </label>
                            <input type="range" class="form-range" id="fontSizeSlider" min="10" max="30" step="1" value="16">
                        </div>
                        
                        <div class="col-md-6">
                            <label class="form-label fw-medium">Display Options</label>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="showText" checked>
                                <label class="form-check-label" for="showText">Show Text Below</label>
                            </div>
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="showBorder" checked>
                                <label class="form-check-label" for="showBorder">Show Border</label>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="d-grid gap-2 d-md-flex justify-content-md-start mb-4">
                    <button class="btn btn-gradient px-4 py-3 me-2" id="downloadBtn">
                        <i class="bi bi-download me-2"></i>Download PNG
                    </button>
                    <button class="btn btn-outline-gradient px-4 py-3" id="clearBtn">
                        <i class="bi bi-x-circle me-2"></i>Clear All
                    </button>
                </div>
            </div>
            
            <!-- Right Column: Preview & History -->
            <div class="col-lg-6">
                <!-- Preview Card -->
                <div class="gradient-card p-4 mb-4">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h3 class="h4 fw-bold mb-0">
                            <i class="bi bi-eye me-2 text-primary"></i>Barcode Preview
                        </h3>
                        <div class="badge bg-success bg-gradient">
                            <i class="bi bi-check-circle me-1"></i>Ready
                        </div>
                    </div>
                    
                    <div class="barcode-container" id="barcodePreview">
                        <div class="text-center" id="barcodePlaceholder">
                            <i class="bi bi-upc-scan display-1 text-muted mb-3"></i>
                            <p class="text-muted mb-0">Your barcode will appear here</p>
                            <small class="text-muted">Enter data and click Generate</small>
                        </div>
                        <div id="barcodeOutput" class="d-none"></div>
                    </div>
                    
                    <!-- Barcode Details -->
                    <div class="mt-3" id="barcodeDetails" style="display: none;">
                        <div class="row text-center">
                            <div class="col-md-4">
                                <div class="p-2">
                                    <small class="text-muted d-block">Type</small>
                                    <span class="fw-bold" id="currentType">CODE128</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-2">
                                    <small class="text-muted d-block">Data Length</small>
                                    <span class="fw-bold" id="dataLength">0</span>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-2">
                                    <small class="text-muted d-block">Generated</small>
                                    <span class="fw-bold" id="generatedTime">Just now</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- History Card -->
                <div class="gradient-card p-4">
                    <h3 class="h4 fw-bold mb-3">
                        <i class="bi bi-clock-history me-2 text-primary"></i>Recent Barcodes
                    </h3>
                    
                    <div id="historyContainer">
                        <div class="text-center py-4 text-muted" id="emptyHistory">
                            <i class="bi bi-clock display-4 mb-3"></i>
                            <p class="mb-0">No barcodes generated yet</p>
                            <small>Your generated barcodes will appear here</small>
                        </div>
                        <div id="historyList" class="d-none"></div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer class="mt-5 py-4 text-center text-muted">
        <div class="container">
            <p class="mb-1">Advanced Barcode Generator &copy; 2023</p>
            <p class="small mb-0">Built with Bootstrap 5 & JsBarcode</p>
        </div>
    </footer>
    
    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- JsBarcode Library -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    
    <!-- HTML2Canvas for download -->
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <!-- Main Application Script -->
    <script>
        // Application state
        let currentBarcode = null;
        let history = JSON.parse(localStorage.getItem('barcodeHistory')) || [];
        let currentColor = '#667eea';
        let currentSettings = {
            width: 2,
            height: 100,
            fontSize: 16,
            showText: true,
            showBorder: true
        };
        
        // DOM Elements
        const barcodeData = document.getElementById('barcodeData');
        const generateBtn = document.getElementById('generateBtn');
        const downloadBtn = document.getElementById('downloadBtn');
        const clearBtn = document.getElementById('clearBtn');
        const barcodePreview = document.getElementById('barcodePreview');
        const barcodePlaceholder = document.getElementById('barcodePlaceholder');
        const barcodeOutput = document.getElementById('barcodeOutput');
        const barcodeDetails = document.getElementById('barcodeDetails');
        const historyContainer = document.getElementById('historyContainer');
        const historyList = document.getElementById('historyList');
        const emptyHistory = document.getElementById('emptyHistory');
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Load history
            loadHistory();
            
            // Update slider value displays
            updateSliderValues();
            
            // Add event listeners
            generateBtn.addEventListener('click', generateBarcode);
            downloadBtn.addEventListener('click', downloadBarcode);
            clearBtn.addEventListener('click', clearAll);
            
            // Enter key support
            barcodeData.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') generateBarcode();
            });
            
            // Color selection
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', function() {
                    document.querySelectorAll('.color-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    this.classList.add('active');
                    currentColor = this.getAttribute('data-color');
                    if (currentBarcode) {
                        generateBarcode();
                    }
                });
            });
            
            // Settings sliders
            document.getElementById('widthSlider').addEventListener('input', function() {
                currentSettings.width = parseFloat(this.value);
                document.getElementById('widthValue').textContent = this.value;
                if (currentBarcode) generateBarcode();
            });
            
            document.getElementById('heightSlider').addEventListener('input', function() {
                currentSettings.height = parseInt(this.value);
                document.getElementById('heightValue').textContent = this.value;
                if (currentBarcode) generateBarcode();
            });
            
            document.getElementById('fontSizeSlider').addEventListener('input', function() {
                currentSettings.fontSize = parseInt(this.value);
                document.getElementById('fontSizeValue').textContent = this.value;
                if (currentBarcode) generateBarcode();
            });
            
            // Toggle switches
            document.getElementById('showText').addEventListener('change', function() {
                currentSettings.showText = this.checked;
                if (currentBarcode) generateBarcode();
            });
            
            document.getElementById('showBorder').addEventListener('change', function() {
                if (this.checked) {
                    barcodePreview.classList.add('active');
                } else {
                    barcodePreview.classList.remove('active');
                }
            });
            
            // Barcode type selection
            document.querySelectorAll('input[name="barcodeType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    if (currentBarcode) generateBarcode();
                });
            });
            
            // Generate initial barcode
            setTimeout(() => generateBarcode(), 500);
        });
        
        // Generate barcode
        function generateBarcode() {
            const data = barcodeData.value.trim();
            const barcodeType = document.querySelector('input[name="barcodeType"]:checked').value;
            
            // Validate input
            if (!data) {
                showAlert('Please enter some text or a URL!', 'warning');
                return;
            }
            
            // Validate barcode type and data
            if (barcodeType === 'EAN13' && !/^\d{13}$/.test(data)) {
                showAlert('EAN-13 requires exactly 13 digits!', 'warning');
                return;
            }
            
            if (barcodeType === 'UPC' && !/^\d{12}$/.test(data)) {
                showAlert('UPC-A requires exactly 12 digits!', 'warning');
                return;
            }
            
            // Show loading state
            barcodePlaceholder.innerHTML = `
                <div class="loader mx-auto mb-3"></div>
                <p class="text-primary mb-0">Generating barcode...</p>
            `;
            barcodePlaceholder.classList.remove('d-none');
            barcodeOutput.classList.add('d-none');
            barcodeDetails.style.display = 'none';
            
            // Clear previous barcode
            barcodeOutput.innerHTML = '';
            
            // Generate after a short delay for UX
            setTimeout(() => {
                try {
                    // Create SVG container
                    const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
                    svg.id = 'barcode-svg';
                    barcodeOutput.appendChild(svg);
                    
                    // Generate the barcode
                    JsBarcode("#barcode-svg", data, {
                        format: barcodeType,
                        lineColor: currentColor,
                        width: currentSettings.width,
                        height: currentSettings.height,
                        displayValue: currentSettings.showText,
                        fontSize: currentSettings.fontSize,
                        textMargin: 5,
                        margin: 15
                    });
                    
                    // Update UI
                    barcodePlaceholder.classList.add('d-none');
                    barcodeOutput.classList.remove('d-none');
                    barcodeDetails.style.display = 'block';
                    barcodePreview.classList.add('active', 'pulse');
                    
                    // Update details
                    document.getElementById('currentType').textContent = barcodeType;
                    document.getElementById('dataLength').textContent = data.length;
                    document.getElementById('generatedTime').textContent = 'Just now';
                    
                    // Update history
                    addToHistory(data, barcodeType);
                    
                    // Update current barcode reference
                    currentBarcode = {
                        data: data,
                        type: barcodeType,
                        svg: svg
                    };
                    
                    // Remove pulse animation after 2 seconds
                    setTimeout(() => {
                        barcodePreview.classList.remove('pulse');
                    }, 2000);
                    
                    showAlert('Barcode generated successfully!', 'success');
                    
                } catch (error) {
                    barcodePlaceholder.innerHTML = `
                        <i class="bi bi-exclamation-triangle display-4 text-danger mb-3"></i>
                        <p class="text-danger mb-0">Error generating barcode</p>
                        <small class="text-danger">${error.message}</small>
                    `;
                    barcodePlaceholder.classList.remove('d-none');
                    barcodeOutput.classList.add('d-none');
                    
                    showAlert('Error generating barcode: ' + error.message, 'danger');
                }
            }, 300);
        }
        
        // Download barcode as PNG
        function downloadBarcode() {
            if (!currentBarcode) {
                showAlert('Please generate a barcode first!', 'warning');
                return;
            }
            
            const svgElement = document.querySelector('#barcode-svg');
            if (!svgElement) {
                showAlert('No barcode found to download!', 'warning');
                return;
            }
            
            // Convert SVG to data URL
            const svgData = new XMLSerializer().serializeToString(svgElement);
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            
            // Set canvas dimensions
            canvas.width = svgElement.clientWidth;
            canvas.height = svgElement.clientHeight;
            
            // Create image from SVG
            const img = new Image();
            const svgBlob = new Blob([svgData], { type: 'image/svg+xml;charset=utf-8' });
            const url = URL.createObjectURL(svgBlob);
            
            img.onload = function() {
                ctx.drawImage(img, 0, 0);
                URL.revokeObjectURL(url);
                
                // Create download link
                const pngUrl = canvas.toDataURL('image/png');
                const downloadLink = document.createElement('a');
                downloadLink.href = pngUrl;
                downloadLink.download = `barcode-${currentBarcode.type}-${Date.now()}.png`;
                document.body.appendChild(downloadLink);
                downloadLink.click();
                document.body.removeChild(downloadLink);
                
                showAlert('Barcode downloaded successfully!', 'success');
            };
            
            img.src = url;
        }
        
        // Clear all inputs and barcode
        function clearAll() {
            barcodeData.value = '';
            barcodePlaceholder.classList.remove('d-none');
            barcodeOutput.classList.add('d-none');
            barcodeDetails.style.display = 'none';
            barcodePreview.classList.remove('active');
            currentBarcode = null;
            
            // Reset to default color
            document.querySelectorAll('.color-option').forEach(opt => {
                opt.classList.remove('active');
            });
            document.querySelector('.color-option[data-color="#667eea"]').classList.add('active');
            currentColor = '#667eea';
            
            showAlert('All inputs cleared!', 'info');
        }
        
        // Add barcode to history
        function addToHistory(data, type) {
            const historyItem = {
                id: Date.now(),
                data: data,
                type: type,
                color: currentColor,
                timestamp: new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),
                date: new Date().toLocaleDateString()
            };
            
            // Add to beginning of array
            history.unshift(historyItem);
            
            // Keep only last 10 items
            if (history.length > 10) {
                history = history.slice(0, 10);
            }
            
            // Save to localStorage
            localStorage.setItem('barcodeHistory', JSON.stringify(history));
            
            // Update UI
            loadHistory();
        }
        
        // Load history from localStorage
        function loadHistory() {
            if (history.length === 0) {
                emptyHistory.classList.remove('d-none');
                historyList.classList.add('d-none');
                return;
            }
            
            emptyHistory.classList.add('d-none');
            historyList.classList.remove('d-none');
            historyList.innerHTML = '';
            
            history.forEach(item => {
                const historyElement = document.createElement('div');
                historyElement.className = 'history-item';
                historyElement.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start">
                        <div>
                            <div class="d-flex align-items-center mb-1">
                                <span class="badge bg-primary me-2">${item.type}</span>
                                <small class="text-muted">${item.timestamp}</small>
                            </div>
                            <p class="mb-0 text-truncate">${item.data}</p>
                        </div>
                        <div class="color-preview" style="width: 20px; height: 20px; background: ${item.color}; border-radius: 4px;"></div>
                    </div>
                `;
                
                historyElement.addEventListener('click', function() {
                    barcodeData.value = item.data;
                    document.querySelector(`input[value="${item.type}"]`).checked = true;
                    document.querySelectorAll('.color-option').forEach(opt => {
                        opt.classList.remove('active');
                        if (opt.getAttribute('data-color') === item.color) {
                            opt.classList.add('active');
                            currentColor = item.color;
                        }
                    });
                    
                    generateBarcode();
                    showAlert('Barcode loaded from history!', 'info');
                });
                
                historyList.appendChild(historyElement);
            });
        }
        
        // Update slider value displays
        function updateSliderValues() {
            document.getElementById('widthValue').textContent = currentSettings.width;
            document.getElementById('heightValue').textContent = currentSettings.height;
            document.getElementById('fontSizeValue').textContent = currentSettings.fontSize;
        }
        
        // Show alert/toast message
        function showAlert(message, type) {
            // Remove any existing alerts
            const existingAlert = document.querySelector('.custom-alert');
            if (existingAlert) existingAlert.remove();
            
            // Create alert element
            const alert = document.createElement('div');
            alert.className = `custom-alert alert alert-${type} alert-dismissible fade show position-fixed`;
            alert.style.cssText = 'top: 20px; right: 20px; z-index: 1050; min-width: 300px;';
            alert.innerHTML = `
                ${getAlertIcon(type)} ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            document.body.appendChild(alert);
            
            // Auto-remove after 3 seconds
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.classList.remove('show');
                    setTimeout(() => alert.remove(), 300);
                }
            }, 3000);
        }
        
        // Get icon for alert type
        function getAlertIcon(type) {
            switch(type) {
                case 'success': return '<i class="bi bi-check-circle-fill me-2"></i>';
                case 'warning': return '<i class="bi bi-exclamation-triangle-fill me-2"></i>';
                case 'danger': return '<i class="bi bi-x-circle-fill me-2"></i>';
                case 'info': return '<i class="bi bi-info-circle-fill me-2"></i>';
                default: return '';
            }
        }
    </script>
</body>
</html>

